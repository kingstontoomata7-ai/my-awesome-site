import React, { useState, useEffect, useRef } from 'react';
import { Trophy, Zap, Star, TrendingUp, Award, Crown, Sparkles, Target, Flame, Gift, Settings, Volume2, VolumeX, RotateCcw, Download, Upload, ChevronRight, Lock } from 'lucide-react';

export default function UltimateClicker() {
  const [points, setPoints] = useState(0);
  const [totalClicks, setTotalClicks] = useState(0);
  const [clickPower, setClickPower] = useState(1);
  const [cps, setCps] = useState(0);
  const [level, setLevel] = useState(1);
  const [xp, setXp] = useState(0);
  const [multiplier, setMultiplier] = useState(1);
  const [critChance, setCritChance] = useState(0);
  const [critMultiplier, setCritMultiplier] = useState(2);
  const [comboCount, setComboCount] = useState(0);
  const [maxCombo, setMaxCombo] = useState(0);
  const [prestige, setPrestige] = useState(0);
  const [prestigeBonus, setPrestigeBonus] = useState(1);
  const [goldenClicks, setGoldenClicks] = useState(0);
  const [autoClickerLevel, setAutoClickerLevel] = useState(0);
  const [tab, setTab] = useState('main');
  const [soundEnabled, setSoundEnabled] = useState(true);
  const [particles, setParticles] = useState([]);
  const [floatingTexts, setFloatingTexts] = useState([]);
  const [theme, setTheme] = useState('purple');
  const [showGoldenClick, setShowGoldenClick] = useState(false);
  const [goldenClickPos, setGoldenClickPos] = useState({ x: 0, y: 0 });
  const [achievements, setAchievements] = useState([]);
  const [stats, setStats] = useState({
    totalEarned: 0,
    timeElapsed: 0,
    avgCPS: 0,
    biggestClick: 0
  });
  const comboTimerRef = useRef(null);
  const gameStartRef = useRef(Date.now());

  const themes = {
    purple: { bg: 'from-purple-900 to-indigo-900', accent: 'purple', glow: 'shadow-purple-500/50' },
    blue: { bg: 'from-blue-900 to-cyan-900', accent: 'blue', glow: 'shadow-blue-500/50' },
    green: { bg: 'from-green-900 to-emerald-900', accent: 'green', glow: 'shadow-green-500/50' },
    red: { bg: 'from-red-900 to-orange-900', accent: 'red', glow: 'shadow-red-500/50' },
    pink: { bg: 'from-pink-900 to-rose-900', accent: 'pink', glow: 'shadow-pink-500/50' }
  };

  const upgrades = [
    { id: 'click1', name: 'Better Cursor', cost: 15, effect: () => setClickPower(p => p + 1), desc: '+1 per click', level: 0, maxLevel: 50 },
    { id: 'click2', name: 'Iron Clicker', cost: 100, effect: () => setClickPower(p => p + 5), desc: '+5 per click', level: 0, maxLevel: 25 },
    { id: 'click3', name: 'Steel Clicker', cost: 500, effect: () => setClickPower(p => p + 25), desc: '+25 per click', level: 0, maxLevel: 20 },
    { id: 'crit1', name: 'Lucky Strike', cost: 200, effect: () => setCritChance(c => c + 5), desc: '+5% crit chance', level: 0, maxLevel: 10 },
    { id: 'crit2', name: 'Critical Master', cost: 1000, effect: () => setCritMultiplier(m => m + 0.5), desc: '+0.5x crit damage', level: 0, maxLevel: 10 },
    { id: 'multi1', name: 'Double Trouble', cost: 750, effect: () => setMultiplier(m => m * 1.1), desc: '+10% multiplier', level: 0, maxLevel: 15 }
  ];

  const generators = [
    { id: 'gen1', name: 'Auto Clicker', baseCost: 50, baseGen: 1, level: 0, desc: '1/sec' },
    { id: 'gen2', name: 'Click Factory', baseCost: 300, baseGen: 5, level: 0, desc: '5/sec' },
    { id: 'gen3', name: 'Click Farm', baseCost: 1500, baseGen: 25, level: 0, desc: '25/sec' },
    { id: 'gen4', name: 'Click Empire', baseCost: 8000, baseGen: 100, level: 0, desc: '100/sec' },
    { id: 'gen5', name: 'Click Universe', baseCost: 50000, baseGen: 500, level: 0, desc: '500/sec' },
    { id: 'gen6', name: 'Quantum Clicker', baseCost: 250000, baseGen: 2500, level: 0, desc: '2500/sec' }
  ];

  const [upgradeStates, setUpgradeStates] = useState(upgrades);
  const [generatorStates, setGeneratorStates] = useState(generators);

  const achievementList = [
    { id: 'clicks_100', name: 'First Steps', desc: 'Click 100 times', check: () => totalClicks >= 100, reward: 'points', amount: 500 },
    { id: 'clicks_1000', name: 'Clicking Addict', desc: 'Click 1000 times', check: () => totalClicks >= 1000, reward: 'multiplier', amount: 0.1 },
    { id: 'points_1000', name: 'Millionaire', desc: 'Earn 1000 points', check: () => stats.totalEarned >= 1000, reward: 'points', amount: 1000 },
    { id: 'points_10000', name: 'Rich', desc: 'Earn 10000 points', check: () => stats.totalEarned >= 10000, reward: 'clickPower', amount: 10 },
    { id: 'combo_10', name: 'Combo Master', desc: 'Reach 10x combo', check: () => maxCombo >= 10, reward: 'critChance', amount: 5 },
    { id: 'combo_50', name: 'Combo God', desc: 'Reach 50x combo', check: () => maxCombo >= 50, reward: 'critMultiplier', amount: 1 },
    { id: 'level_10', name: 'Level Up', desc: 'Reach level 10', check: () => level >= 10, reward: 'multiplier', amount: 0.2 },
    { id: 'prestige_1', name: 'New Beginning', desc: 'Prestige once', check: () => prestige >= 1, reward: 'prestigeBonus', amount: 0.1 },
    { id: 'golden_10', name: 'Golden Touch', desc: 'Click 10 golden clicks', check: () => goldenClicks >= 10, reward: 'points', amount: 5000 },
    { id: 'cps_100', name: 'Passive Income', desc: 'Reach 100 CPS', check: () => cps >= 100, reward: 'multiplier', amount: 0.15 }
  ];

  // Auto clicker
  useEffect(() => {
    const interval = setInterval(() => {
      let totalCPS = 0;
      generatorStates.forEach(gen => {
        totalCPS += gen.baseGen * gen.level;
      });
      setCps(totalCPS);
      if (totalCPS > 0) {
        const earned = (totalCPS * multiplier * prestigeBonus) / 10;
        setPoints(p => p + earned);
        setStats(s => ({ ...s, totalEarned: s.totalEarned + earned }));
      }
    }, 100);
    return () => clearInterval(interval);
  }, [generatorStates, multiplier, prestigeBonus]);

  // XP and leveling
  useEffect(() => {
    const xpNeeded = level * 100;
    if (xp >= xpNeeded) {
      setLevel(l => l + 1);
      setXp(x => x - xpNeeded);
      setMultiplier(m => m * 1.05);
      addFloatingText('LEVEL UP!', window.innerWidth / 2, window.innerHeight / 2, '#FFD700');
    }
  }, [xp, level]);

  // Golden click spawn
  useEffect(() => {
    const interval = setInterval(() => {
      if (Math.random() < 0.05) {
        setShowGoldenClick(true);
        setGoldenClickPos({
          x: Math.random() * (window.innerWidth - 100),
          y: Math.random() * (window.innerHeight - 100)
        });
        setTimeout(() => setShowGoldenClick(false), 5000);
      }
    }, 10000);
    return () => clearInterval(interval);
  }, []);

  // Achievements check
  useEffect(() => {
    achievementList.forEach(ach => {
      if (!achievements.includes(ach.id) && ach.check()) {
        setAchievements(a => [...a, ach.id]);
        addFloatingText(`Achievement: ${ach.name}`, window.innerWidth / 2, 100, '#FFD700');
        applyAchievementReward(ach);
      }
    });
  }, [totalClicks, stats, level, maxCombo, prestige, goldenClicks, cps]);

  // Stats timer
  useEffect(() => {
    const interval = setInterval(() => {
      setStats(s => ({ ...s, timeElapsed: Math.floor((Date.now() - gameStartRef.current) / 1000) }));
    }, 1000);
    return () => clearInterval(interval);
  }, []);

  const applyAchievementReward = (ach) => {
    switch (ach.reward) {
      case 'points':
        setPoints(p => p + ach.amount);
        break;
      case 'multiplier':
        setMultiplier(m => m + ach.amount);
        break;
      case 'clickPower':
        setClickPower(p => p + ach.amount);
        break;
      case 'critChance':
        setCritChance(c => c + ach.amount);
        break;
      case 'critMultiplier':
        setCritMultiplier(m => m + ach.amount);
        break;
      case 'prestigeBonus':
        setPrestigeBonus(b => b + ach.amount);
        break;
    }
  };

  const handleClick = (e) => {
    const rect = e.currentTarget.getBoundingClientRect();
    const x = e.clientX - rect.left;
    const y = e.clientY - rect.top;
    
    let earnedPoints = clickPower * multiplier * prestigeBonus;
    const isCrit = Math.random() * 100 < critChance;
    
    if (isCrit) {
      earnedPoints *= critMultiplier;
      addFloatingText(`CRIT! +${Math.floor(earnedPoints)}`, e.clientX, e.clientY, '#FF0000');
    } else {
      addFloatingText(`+${Math.floor(earnedPoints)}`, e.clientX, e.clientY, '#FFD700');
    }
    
    setPoints(p => p + earnedPoints);
    setTotalClicks(c => c + 1);
    setXp(x => x + Math.floor(earnedPoints / 10));
    setStats(s => ({ 
      ...s, 
      totalEarned: s.totalEarned + earnedPoints,
      biggestClick: Math.max(s.biggestClick, earnedPoints)
    }));
    
    // Combo system
    setComboCount(c => Math.min(c + 1, 100));
    if (comboCount > maxCombo) setMaxCombo(comboCount);
    clearTimeout(comboTimerRef.current);
    comboTimerRef.current = setTimeout(() => setComboCount(0), 1000);
    
    // Particles
    for (let i = 0; i < 5; i++) {
      addParticle(x, y);
    }
  };

  const handleGoldenClick = (e) => {
    e.stopPropagation();
    const bonus = points * 0.5 + 1000;
    setPoints(p => p + bonus);
    setGoldenClicks(g => g + 1);
    setShowGoldenClick(false);
    addFloatingText(`GOLDEN! +${Math.floor(bonus)}`, e.clientX, e.clientY, '#FFD700');
  };

  const addParticle = (x, y) => {
    const particle = {
      id: Math.random(),
      x,
      y,
      vx: (Math.random() - 0.5) * 4,
      vy: (Math.random() - 0.5) * 4 - 2
    };
    setParticles(p => [...p, particle]);
    setTimeout(() => {
      setParticles(p => p.filter(pa => pa.id !== particle.id));
    }, 1000);
  };

  const addFloatingText = (text, x, y, color) => {
    const ft = { id: Math.random(), text, x, y, color };
    setFloatingTexts(f => [...f, ft]);
    setTimeout(() => {
      setFloatingTexts(f => f.filter(t => t.id !== ft.id));
    }, 2000);
  };

  const buyUpgrade = (upg) => {
    const upgrade = upgradeStates.find(u => u.id === upg.id);
    if (!upgrade || upgrade.level >= upgrade.maxLevel) return;
    
    const cost = upg.cost * Math.pow(1.15, upgrade.level);
    if (points >= cost) {
      setPoints(p => p - cost);
      upg.effect();
      setUpgradeStates(ups => ups.map(u => 
        u.id === upg.id ? { ...u, level: u.level + 1 } : u
      ));
    }
  };

  const buyGenerator = (gen) => {
    const generator = generatorStates.find(g => g.id === gen.id);
    const cost = gen.baseCost * Math.pow(1.15, generator.level);
    if (points >= cost) {
      setPoints(p => p - cost);
      setGeneratorStates(gens => gens.map(g => 
        g.id === gen.id ? { ...g, level: g.level + 1 } : g
      ));
    }
  };

  const handlePrestige = () => {
    if (level < 20) return;
    const prestigeGain = Math.floor(level / 10);
    setPrestige(p => p + prestigeGain);
    setPrestigeBonus(b => b + prestigeGain * 0.1);
    
    // Reset
    setPoints(0);
    setLevel(1);
    setXp(0);
    setClickPower(1);
    setTotalClicks(0);
    setComboCount(0);
    setUpgradeStates(upgrades);
    setGeneratorStates(generators);
  };

  const saveGame = () => {
    const saveData = {
      points, totalClicks, clickPower, level, xp, multiplier, critChance, critMultiplier,
      prestige, prestigeBonus, goldenClicks, upgradeStates, generatorStates, achievements, stats, maxCombo
    };
    const blob = new Blob([JSON.stringify(saveData)], { type: 'application/json' });
    const url = URL.createObjectURL(blob);
    const a = document.createElement('a');
    a.href = url;
    a.download = 'clicker_save.json';
    a.click();
  };

  const loadGame = (e) => {
    const file = e.target.files[0];
    if (file) {
      const reader = new FileReader();
      reader.onload = (ev) => {
        const data = JSON.parse(ev.target.result);
        setPoints(data.points || 0);
        setTotalClicks(data.totalClicks || 0);
        setClickPower(data.clickPower || 1);
        setLevel(data.level || 1);
        setXp(data.xp || 0);
        setMultiplier(data.multiplier || 1);
        setCritChance(data.critChance || 0);
        setCritMultiplier(data.critMultiplier || 2);
        setPrestige(data.prestige || 0);
        setPrestigeBonus(data.prestigeBonus || 1);
        setGoldenClicks(data.goldenClicks || 0);
        setUpgradeStates(data.upgradeStates || upgrades);
        setGeneratorStates(data.generatorStates || generators);
        setAchievements(data.achievements || []);
        setStats(data.stats || stats);
        setMaxCombo(data.maxCombo || 0);
      };
      reader.readAsText(file);
    }
  };

  const resetGame = () => {
    if (!confirm('Reset all progress?')) return;
    setPoints(0);
    setTotalClicks(0);
    setClickPower(1);
    setLevel(1);
    setXp(0);
    setMultiplier(1);
    setCritChance(0);
    setCritMultiplier(2);
    setPrestige(0);
    setPrestigeBonus(1);
    setGoldenClicks(0);
    setComboCount(0);
    setMaxCombo(0);
    setUpgradeStates(upgrades);
    setGeneratorStates(generators);
    setAchievements([]);
    setStats({ totalEarned: 0, timeElapsed: 0, avgCPS: 0, biggestClick: 0 });
    gameStartRef.current = Date.now();
  };

  const formatNumber = (num) => {
    if (num >= 1e12) return (num / 1e12).toFixed(2) + 'T';
    if (num >= 1e9) return (num / 1e9).toFixed(2) + 'B';
    if (num >= 1e6) return (num / 1e6).toFixed(2) + 'M';
    if (num >= 1e3) return (num / 1e3).toFixed(2) + 'K';
    return Math.floor(num).toLocaleString();
  };

  const formatTime = (seconds) => {
    const h = Math.floor(seconds / 3600);
    const m = Math.floor((seconds % 3600) / 60);
    const s = seconds % 60;
    return `${h}h ${m}m ${s}s`;
  };

  return (
    <div className={`min-h-screen bg-gradient-to-br ${themes[theme].bg} text-white p-4 overflow-hidden relative`}>
      {/* Particles */}
      {particles.map(p => (
        <div
          key={p.id}
          className="absolute w-2 h-2 bg-yellow-400 rounded-full pointer-events-none animate-ping"
          style={{ left: p.x, top: p.y }}
        />
      ))}
      
      {/* Floating texts */}
      {floatingTexts.map(ft => (
        <div
          key={ft.id}
          className="absolute font-bold text-2xl pointer-events-none animate-bounce"
          style={{ left: ft.x, top: ft.y, color: ft.color }}
        >
          {ft.text}
        </div>
      ))}

      {/* Golden Click */}
      {showGoldenClick && (
        <button
          onClick={handleGoldenClick}
          className="absolute w-20 h-20 bg-yellow-400 rounded-full animate-pulse shadow-2xl shadow-yellow-500/50 flex items-center justify-center text-4xl hover:scale-110 transition-transform z-50"
          style={{ left: goldenClickPos.x, top: goldenClickPos.y }}
        >
          ‚≠ê
        </button>
      )}

      {/* Top Bar */}
      <div className="max-w-7xl mx-auto mb-4">
        <div className="bg-black/30 backdrop-blur rounded-lg p-4 flex flex-wrap gap-4 justify-between items-center">
          <div className="flex items-center gap-4">
            <div>
              <div className="text-sm opacity-70">Points</div>
              <div className="text-3xl font-bold">{formatNumber(points)}</div>
            </div>
            <div>
              <div className="text-sm opacity-70">Level {level}</div>
              <div className="w-40 bg-gray-700 rounded-full h-2">
                <div 
                  className={`bg-${themes[theme].accent}-500 h-2 rounded-full transition-all`}
                  style={{ width: `${(xp / (level * 100)) * 100}%` }}
                />
              </div>
            </div>
            <div>
              <div className="text-sm opacity-70">CPS</div>
              <div className="text-xl font-bold">{formatNumber(cps * multiplier * prestigeBonus)}</div>
            </div>
          </div>
          <div className="flex gap-2">
            <button onClick={() => setSoundEnabled(!soundEnabled)} className="p-2 bg-white/10 rounded hover:bg-white/20">
              {soundEnabled ? <Volume2 size={20} /> : <VolumeX size={20} />}
            </button>
            <button onClick={saveGame} className="p-2 bg-white/10 rounded hover:bg-white/20">
              <Download size={20} />
            </button>
            <label className="p-2 bg-white/10 rounded hover:bg-white/20 cursor-pointer">
              <Upload size={20} />
              <input type="file" onChange={loadGame} className="hidden" accept=".json" />
            </label>
            <button onClick={resetGame} className="p-2 bg-white/10 rounded hover:bg-white/20">
              <RotateCcw size={20} />
            </button>
          </div>
        </div>
      </div>

      {/* Main Content */}
      <div className="max-w-7xl mx-auto grid grid-cols-1 lg:grid-cols-3 gap-4">
        {/* Left Sidebar */}
        <div className="space-y-4">
          <div className="bg-black/30 backdrop-blur rounded-lg p-4">
            <h3 className="font-bold mb-2 flex items-center gap-2">
              <Trophy className="text-yellow-400" size={20} />
              Stats
            </h3>
            <div className="space-y-1 text-sm">
              <div className="flex justify-between">
                <span>Total Clicks:</span>
                <span className="font-bold">{totalClicks.toLocaleString()}</span>
              </div>
              <div className="flex justify-between">
                <span>Click Power:</span>
                <span className="font-bold">{formatNumber(clickPower)}</span>
              </div>
              <div className="flex justify-between">
                <span>Multiplier:</span>
                <span className="font-bold">{multiplier.toFixed(2)}x</span>
              </div>
              <div className="flex justify-between">
                <span>Crit Chance:</span>
                <span className="font-bold">{critChance.toFixed(1)}%</span>
              </div>
              <div className="flex justify-between">
                <span>Crit Multi:</span>
                <span className="font-bold">{critMultiplier.toFixed(1)}x</span>
              </div>
              <div className="flex justify-between">
                <span>Combo:</span>
                <span className="font-bold">{comboCount}x (Max: {maxCombo})</span>
              </div>
              <div className="flex justify-between">
                <span>Prestige:</span>
                <span className="font-bold">{prestige} (+{((prestigeBonus - 1) * 100).toFixed(0)}%)</span>
              </div>
              <div className="flex justify-between">
                <span>Golden Clicks:</span>
                <span className="font-bold">{goldenClicks}</span>
              </div>
              <div className="flex justify-between">
                <span>Time Played:</span>
                <span className="font-bold">{formatTime(stats.timeElapsed)}</span>
              </div>
              <div className="flex justify-between">
                <span>Total Earned:</span>
                <span className="font-bold">{formatNumber(stats.totalEarned)}</span>
              </div>
              <div className="flex justify-between">
                <span>Biggest Click:</span>
                <span className="font-bold">{formatNumber(stats.biggestClick)}</span>
              </div>
            </div>
          </div>

          <div className="bg-black/30 backdrop-blur rounded-lg p-4">
            <h3 className="font-bold mb-2 flex items-center gap-2">
              <Settings size={20} />
              Themes
            </h3>
            <div className="flex gap-2 flex-wrap">
              {Object.keys(themes).map(t => (
                <button
                  key={t}
                  onClick={() => setTheme(t)}
                  className={`w-8 h-8 rounded-full bg-${themes[t].accent}-500 ${theme === t ? 'ring-2 ring-white' : ''}`}
                />
              ))}
            </div>
          </div>
        </div>

        {/* Center - Clicker */}
        <div className="flex flex-col items-center justify-center">
          <button
            onClick={handleClick}
            className={`w-64 h-64 rounded-full bg-gradient-to-br from-${themes[theme].accent}-400 to-${themes[theme].accent}-600 shadow-2xl ${themes[theme].glow} hover:scale-105 active:scale-95 transition-all flex items-center justify-center text-6xl relative overflow-hidden group`}
          >
            <div className="absolute inset-0 bg-white/20 group-hover:bg-white/30 transition-all" />
            <Sparkles className="relative z-10" size={80} />
          </button>
          <div className="mt-6 text-center">
            <div className="text-2xl font-bold">
              +{formatNumber(clickPower * multiplier * prestigeBonus)} per click
            </div>
            {comboCount > 1 && (
              <div className="text-xl text-yellow-400 animate-pulse mt-2">
                {comboCount}x COMBO!
              </div>
            )}
          </div>
        </div>

        {/* Right Sidebar - Tabs */}
        <div className="bg-black/30 backdrop-blur rounded-lg p-4">
          <div className="flex gap-2 mb-4 border-b border-white/20">
            {['Upgrades', 'Generators', 'Prestige', 'Achievements'].map(t => (
              <button
                key={t}
                onClick={() => setTab(t.toLowerCase())}
                className={`px-3 py-2 ${tab === t.toLowerCase() ? 'border-b-2 border-white' : 'opacity-50'}`}
              >
                {t}
              </button>
            ))}
          </div>

          <div className="space-y-2 max-h-[600px] overflow-y-auto">
            {tab === 'upgrades' && upgradeStates.map(upg => {
              const cost = upg.cost * Math.pow(1.15, upg.level);
              const canBuy = points >= cost && upg.level < upg.maxLevel;
              return (
                <button
                  key={upg.id}
                  onClick={() => buyUpgrade(upg)}
                  disabled={!canBuy}
                  className={`w-full p-3 rounded-lg text-left ${canBuy ? 'bg-green-600/30 hover:bg-green-600/50' : 'bg-gray-600/30'} transition-all`}
                >
                  <div className="flex justify-between items-start">
                    <div>
                      <div className="font-bold">{upg.name}</div>
                      <div className="text-sm opacity-70">{upg.desc}</div>
                      <div className="text-xs mt-1">Level: {upg.level}/{upg.maxLevel}</div>
                    </div>
                    <div className="text-right">
                      <div className="font-bold">{formatNumber(cost)}</div>
                      <Zap size={16} className="inline" />
                    </div>
                  </div>
                </button>
              );
            })}

            {tab === 'generators' && generatorStates.map(gen => {
              const cost = gen.baseCost * Math.pow(1.15, gen.level);
              const canBuy = points >= cost;
              return (
                <button
                  key={gen.id}
                  onClick={() => buyGenerator(gen)}
                  disabled={!canBuy}
                  className={`w-full p-3 rounded-lg text-left ${canBuy ? 'bg-blue-600/30 hover:bg-blue-600/50' : 'bg-gray-600/30'} transition-all`}
                >
                  <div className="flex justify-between items-start">
                    <div>
                      <div className="font-bold">{gen.name}</div>
                      <div className="text-sm opacity-70">{gen.desc}</div>
                      <div className="text-xs mt-1">Owned: {gen.level}</div>
                      <div className="text-xs">Total: {formatNumber(gen.baseGen * gen.level)}/sec</div>
                    </div>
                    <div className="text-right">
                      <div className="font-bold">{formatNumber(cost)}</div>
                      <TrendingUp size={16} className="inline" />
                    </div>
                  </div>
                </button>
              );
            })}

            {tab === 'prestige' && (
              <div className="space-y-4">
                <div className="bg-yellow-600/20 p-4 rounded-lg border border-yellow-500/50">
                  <div className="flex items-center gap-2 mb-2">
                    <Crown className="text-yellow-400" size={24} />
                    <h3 className="font-bold text-xl">Prestige System</h3>
                  </div>
                  <p className="text-sm opacity-80 mb-4">
                    Reset your progress for permanent bonuses! Requires level 20+
                  </p>
                  <div className="space-y-2 mb-4">
                    <div className="flex justify-between">
                      <span>Current Prestige:</span>
                      <span className="font-bold">{prestige}</span>
                    </div>
                    <div className="flex justify-between">
                      <span>Current Bonus:</span>
                      <span className="font-bold text-green-400">+{((prestigeBonus - 1) * 100).toFixed(0)}%</span>
                    </div>
                    <div className="flex justify-between">
                      <span>Next Prestige Gain:</span>
                      <span className="font-bold text-yellow-400">{level >= 20 ? Math.floor(level / 10) : 0}</span>
                    </div>
                  </div>
                  <button
                    onClick={handlePrestige}
                    disabled={level < 20}
                    className={`w-full py-3 rounded-lg font-bold ${level >= 20 ? 'bg-yellow-500 hover:bg-yellow-600' : 'bg-gray-600 cursor-not-allowed'}`}
                  >
                    {level >= 20 ? '‚ú® PRESTIGE NOW ‚ú®' : `üîí Reach Level 20 (${level}/20)`}
                  </button>
                </div>
                <div className="bg-purple-600/20 p-4 rounded-lg">
                  <h4 className="font-bold mb-2">Prestige Benefits:</h4>
                  <ul className="text-sm space-y-1 opacity-80">
                    <li>‚Ä¢ +10% to all production per prestige level</li>
                    <li>‚Ä¢ Keep all achievements</li>
                    <li>‚Ä¢ Unlock higher tier upgrades</li>
                    <li>‚Ä¢ Faster progression on reset</li>
                  </ul>
                </div>
              </div>
            )}

            {tab === 'achievements' && (
              <div className="space-y-2">
                {achievementList.map(ach => {
                  const unlocked = achievements.includes(ach.id);
                  return (
                    <div
                      key={ach.id}
                      className={`p-3 rounded-lg ${unlocked ? 'bg-green-600/30 border border-green-500/50' : 'bg-gray-600/30'}`}
                    >
                      <div className="flex items-start gap-3">
                        <div className="mt-1">
                          {unlocked ? (
                            <Award className="text-yellow-400" size={24} />
                          ) : (
                            <Lock className="opacity-30" size={24} />
                          )}
                        </div>
                        <div className="flex-1">
                          <div className="font-bold flex items-center gap-2">
                            {ach.name}
                            {unlocked && <span className="text-xs bg-green-500 px-2 py-0.5 rounded">UNLOCKED</span>}
                          </div>
                          <div className="text-sm opacity-70">{ach.desc}</div>
                          <div className="text-xs mt-1 text-yellow-400">
                            Reward: {ach.reward} +{ach.amount}
                          </div>
                        </div>
                      </div>
                    </div>
                  );
                })}
              </div>
            )}
          </div>
        </div>
      </div>

      {/* Bottom Info Bar */}
      <div className="max-w-7xl mx-auto mt-4">
        <div className="bg-black/30 backdrop-blur rounded-lg p-3 text-center text-sm">
          <div className="flex flex-wrap justify-center gap-4">
            <span>üíé Achievements: {achievements.length}/{achievementList.length}</span>
            <span>üî• Max Combo: {maxCombo}x</span>
            <span>‚≠ê Golden Clicks: {goldenClicks}</span>
            <span>üëë Prestige Level: {prestige}</span>
          </div>
        </div>
      </div>
    </div>
  );
}
